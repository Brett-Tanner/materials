-# locals: (users:)

= turbo_frame_tag 'user_table' do
  %table.w-full.text-center
    %thead
      %tr.text-ku-purple
        %th{ class: 'p-2 bg-ku-orange/50 rounded-s-lg border-r border-r-white' }
          = t('.name')
        %th{ class: 'p-2 bg-ku-orange/50 border-r border-r-white' }
          = t('.role')
        %th{ class: 'p-2 bg-ku-orange/50 border-r border-r-white' }
          = t('.email')

        - if current_user.is?('Admin')
          %th{ class: 'p-2 bg-ku-orange/50 border-r border-r-white' }
            = t('.org')
          %th{ class: 'p-2 bg-ku-orange/50 border-r border-r-white' }
            = t('.last_signin')
          %th{ class: 'p-2 bg-ku-orange/50 border-r border-r-white' }
            = t('.last_ip')
          %th{ class: 'p-2 bg-ku-orange/50 border-r border-r-white' }
            = t('.signin_count')

        %th{ class: 'p-2 bg-ku-orange/50 rounded-e-lg' }
          = t('.created')
    %tbody
      - users.each do |user|
        %tr
          %td
            = link_to user.name,
                      organisation_user_path(user.organisation_id, user)
          %td= split_on_capitals(user.type)
          %td= mail_to user.email

          - if current_user.is?('Admin')
            %td= user.organisation.name
            %td= ja_date(user.last_sign_in_at)
            %td= user.last_sign_in_ip
            %td= user.sign_in_count

          %td= ja_date(user.created_at)
