:ruby
  border = "border-b-2 #{lvl_border(@lesson.short_level)}"
  text = lvl_text(@lesson.short_level)
  # TODO: Must be a better way to do this
  course_lesson = @teacher.course_lessons.find_by(lesson_id: @lesson.id)
  plan = @teacher.plans.find_by(course_id: course_lesson.course_id)
  week = @teacher.course_week(plan, @date)
  phonics_resources = @lesson.phonics_resources.where(week:).includes(:blob)
  sorted_resources = (@lesson.resources.includes(:blob) + phonics_resources)
                     .sort_by { |r| r.blob.filename }

= turbo_frame_tag 'lesson' do
  = render 'teacher_lessons/tabs',
           lessons: @type_lessons, active_lesson: @lesson, level: @level,
           teacher_id: @teacher.id, type: @type, date: @date

  .content
    %header
      %h1{ class: "type #{border}" }
        = @lesson.type.titleize
      %h1{ class: "level #{text} #{border}" }
        = @lesson.short_level.upcase
      = image_tag type_icon_path(@lesson)
      %h3.details= @lesson.goal

    - if @lesson.guide.attached?
      = render 'teacher_lessons/guide_section',
               lesson: @lesson

    - if sorted_resources.any?
      = render 'teacher_lessons/resources_section',
               resources: sorted_resources
