-# locals: (lesson: nil, proposals:)

- if proposals.any?
  %table.text-center#proposals
    %thead
      %tr
        - unless lesson
          %th Lesson
        %th Proponent
        %th Comments
        %th Status
        - if current_user.is?('Admin')
          %th
    %tbody
      - proposals.each do |proposal|
        %tr
          - unless lesson
            %td.p-3
              = link_to proposal.title,
                        edit_lesson_path(proposal)
          - if current_user.is?('Admin')
            = form_with model: proposal do |f|
              %td= proposal.creator.name
              - if current_user.is?('Admin')
                %td= f.text_area :internal_notes
                %td= f.select :status,
                              Lesson.statuses.keys.map { |k| [k.humanize, k] }
                %td= f.submit 'Update', class: 'btn btn-primary'
          - else
            %td Proposed by: #{proposal.creator.name}
            %td= proposal.internal_notes
            %td= proposal.status.titleize
